<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">

<h:head>
	<meta http-equiv="cache-control" content="no-cache" />
	<meta http-equiv="expires" content="0" />
	<meta http-equiv="pragma" content="no-cache" />
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />

	<script src="http://maps.google.com/maps/api/js?sensor=false"
		type="text/javascript"></script>
	<h:outputStylesheet library="css" name="icon.css" />
</h:head>
<h:body style="height: 100%">
	<h:form id="remoteCommandForm" prependId="true">
		<!-- update=":filterContentContainer, :centerContentContainer" -->
		<p:remoteCommand name="updateFilterAndContent" global="false"
			async="true" partialSubmit="true" />
	</h:form>

	<p:ajaxStatus onstart="PF('statusDialog').show()"
		onsuccess="PF('statusDialog').hide()" />

	<pe:layout id="fullPage" widgetVar="fpLayoutWidget">
		<pe:layoutPane position="north">
			<f:facet name="header">
				<h:outputText value="#{msg.filter}" />
			</f:facet>
			<h:panelGroup id="filterContentContainer" layout="block">
				<ui:insert name="filterContent" />
			</h:panelGroup>
		</pe:layoutPane>

		<pe:layoutPane position="west" minSize="20%">
			<f:facet name="header">
				<h:outputText value="#{msg.artists}" />
			</f:facet>
			<h:panelGroup id="westContentContainer" layout="block">
				<ui:insert name="westContent" />
			</h:panelGroup>
		</pe:layoutPane>

		<pe:layoutPane position="center">
			<f:facet name="header">
				<h:outputText value="#{msg.performances}" />
			</f:facet>
			<h:panelGroup id="centerContentContainer" layout="block">
				<ui:insert name="centerContent" />
			</h:panelGroup>
		</pe:layoutPane>
	</pe:layout>

	<h:panelGroup id="dialogGroup" layout="block">
		<ui:insert name="dialogContent" />

		<p:dialog widgetVar="statusDialog" modal="true" draggable="false"
			closable="false" resizable="false" showHeader="false"
			appendTo="@(body)" style="z-index: -1000000000">
			<h:panelGrid columns="2"
				columnClasses="ui-dialog-message-image, ui-dialog-message-text">
				<p:graphicImage library="images" name="loading.gif" width="100"
					height="100" />
				<h:outputText value="#{coreMsg.loadingPage}" />
			</h:panelGrid>
		</p:dialog>

		<h:form id="loginDialogForm" prependId="true">
			<p:dialog id="loginDialogID" rendered="#{not utxModel.logged}"
				widgetVar="loginDialog" closable="true" closeOnEscape="true"
				draggable="true" responsive="true" fitViewport="true"
				resizable="true" position="center" header="#{msg.login}"
				modal="true" width="500" style="padding: 10px;">

				<p:ajax event="close" process="@this"
					update=":filterContentContainer, :centerContentContainer, :menuStackForm" />

				<h:panelGroup id="formContainer"
					styleClass="ui-grid ui-grid-responsive" style="max-width: 800px;">
					<div class="ui-grid-row">
						<div class="ui-grid-col-12" style="padding: 5px;">
							<p:messages for="loginButton" />
						</div>
					</div>
					<div class="ui-grid-row">
						<div class="ui-grid-col-4" style="padding: 5px;">
							<p:outputLabel id="usernameLabel" value="#{msg.username}" />
						</div>
						<div class="ui-grid-col-7" style="padding: 5px;">
							<p:inputText id="username" value="#{loginBean.username}"
								required="true" />
						</div>
						<div class="ui-grid-col-1" style="padding: 5px;">
							<p:message for="username" display="icon" />
						</div>
					</div>
					<div class="ui-grid-row">
						<div class="ui-grid-col-4" style="padding: 5px;">
							<p:outputLabel id="passwordLabel" value="#{msg.password}" />
						</div>
						<div class="ui-grid-col-7" style="padding: 5px;">
							<p:inputText id="password" value="#{loginBean.password}"
								required="true" />
						</div>
						<div class="ui-grid-col-1" style="padding: 5px;">
							<p:message for="password" display="icon" />
						</div>
					</div>
					<div class="ui-grid-row">
						<div class="ui-grid-col-12"
							style="padding: 5px; text-align: center">
							<p:commandButton id="loginButton" icon="fa fa-key"
								title="#{msg.login}" actionListener="#{loginBean.login}"
								process="@form" update="formContainer" global="true">
							</p:commandButton>
						</div>
					</div>
				</h:panelGroup>
			</p:dialog>
		</h:form>
	</h:panelGroup>

	<h:panelGroup id="messageGroup" layout="block">
		<p:growl id="globalErrorMessageRow" autoUpdate="true"
			globalOnly="true" showSummary="true" sticky="true" severity="error" />
		<p:growl id="globalInfoMessageRow" autoUpdate="true" globalOnly="true"
			showSummary="true" life="2000" severity="info" />
	</h:panelGroup>

	<h:form id="menuStackForm" prependId="true">
		<p:stack id="menuStack" icon="/resources/images/stack.png"
			expanded="true">
			<p:menuitem value="#{msg.login}" rendered="#{not utxModel.logged}"
				icon="/resources/images/lock.png" global="true"
				update=":dialogGroup" oncomplete="PF('loginDialog').show();">
				<p:resetInput target=":dialogGroup" />
			</p:menuitem>
			<p:menuitem value="#{msg.logout}" rendered="#{utxModel.logged}"
				icon="/resources/images/lock.png"
				actionListener="#{loginBean.logout()}" global="true"
				update="@form, :filterContentContainer, :centerContentContainer, :menuStackForm" />
		</p:stack>
	</h:form>
</h:body>
</html>
